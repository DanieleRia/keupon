<script type="text/javascript">
   JotForm.init();
</script>

<script type="text/javascript">

function call_offers(deal, status){
  if(status == "offered" || status == "accepted"){
    location.href='/offered_deals?deal='+deal;
  }
  else{
    location.href='/want_a_deal?id='+deal;
    //new Ajax.Request('/customers/want_a_deal?id='+deal, {asynchronous:true, evalScripts:true, parameters:'authenticity_token=' + encodeURIComponent('f7451406a5f3527c920b15eb7f63840280305729')});
  }
}

function setButtonStatus(status){
  var theForm = document.getElementById("2730422465");
  theForm.button_status.value = status;
}

</script>

<script Language="JavaScript">
<!--
function form_validator(){
var theForm = document.getElementById("2730422465");
var i;
if (document.getElementById("description").value == "" || document.getElementById("description").value.length < 1)
{
alert("You must Describe the Keupon that you are looking for.");
  document.getElementById("description").focus();
  return (false);
}

if (theForm.price.value == "" || theForm.price.value.length < 1)
{
alert("You must enter Price.");
theForm.price.focus();
return (false);
}
else if(!IsNumeric(theForm.price.value)){
  alert("You must enter only Numeric value for Price.");
  theForm.price.focus();
  return (false);
}

if (theForm.quantity.value == "" || theForm.quantity.value.length < 1)
{
alert("You must enter the number of Keupons that you will buy.");
theForm.quantity.focus();
return (false);
}
else if(!IsNumeric(theForm.quantity.value)){
  alert("You must enter only Numeric value for number of Keupons.");
  theForm.quantity.focus();
  return (false);
}


if (theForm.deadline.value == "" || theForm.deadline.value.length < 1)
{
alert("You must pick the Date by when you are expecting a response for this Deal.");
theForm.deadline.focus();
return (false);
}else if(!checkDate(theForm.deadline)){
  theForm.deadline.focus();
  return (false);
}

if (theForm.category.selectedIndex == '0')
{
alert("You must Categorize your Keupon.");
theForm.category.focus();
return (false);
}

theForm.submit();
}

function checkDate(field) {
  var minYear = 1902;
  var maxYear = (new Date()).getFullYear();
  var errorMsg = ""; // regular expression to match required date format
  re = /^(\d{1,2})\/(\d{1,2})\/(\d{4})$/;
  if(field.value != '') {
    if(regs = field.value.match(re)) {
      if(regs[1] < 1 || regs[1] > 31) {
        errorMsg = "Invalid value for day: " + regs[1];
      } else if(regs[2] < 1 || regs[2] > 12) {
        errorMsg = "Invalid value for month: " + regs[2];
      } else if(regs[3] < maxYear) {
        errorMsg = "Invalid value for year: " + regs[3] + " - must be between greater than or equal to " + maxYear;
      }
    } else {
      errorMsg = "Invalid date format: " + field.value;
    }
  } 
  if(errorMsg != "") {
    alert(errorMsg); return false;
  }
  return true;
}

function IsNumeric(sText)

{
   var ValidChars = "0123456789.";
   var IsNumber=true;
   var Char;


   for (i = 0; i < sText.length && IsNumber == true; i++)
      {
      Char = sText.charAt(i);
      if (ValidChars.indexOf(Char) == -1)
         {
         IsNumber = false;
         }
      }
   return IsNumber;

}


//-->
</script>

<tr>
        <td height="55" background="images/header_red_bg.jpg"><table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="13%" align="left"><img src="images/deals_on_demand_header_text.jpg" width="320" height="55" /></td>
            <td width="87%" class="header_text">&nbsp;</td>
          </tr>
        </table></td>
      </tr>

      <tr>
        <td valign="top" background="images/deals_on_demand_bg.jpg" ><table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="3%">&nbsp;</td>
            <td width="55%">&nbsp;</td>
            <td colspan="2">&nbsp;</td>
            <td width="2%">&nbsp;</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td height="121" background="images/deals_on_demand_sale_box.png" style="background-repeat:no-repeat;"><table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td width="27%">&nbsp;</td>
                <td width="63%" align="left" class="deals_on_demand_text2"><%= @msg  %></td>
                <td width="10%">&nbsp;</td>
              </tr>
            </table></td>
            <td width="1%">&nbsp;</td>
            <td width="39%" rowspan="3" valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td height="35" align="center" class="deals_on_demand_text_bold">Deals that You Demanded</td>
              </tr>
              <tr>
                <td>
                  <table width="100%" border="0" cellspacing="0" cellpadding="0">
                  <tr>
                    <td height="33" background="images/deals_on_demand_red_bar.jpg">
                      <table width="100%" border="0" cellspacing="2" cellpadding="0">
                      <tr>
                        <td width="28%" height="28" align="center" class="deals_on_demand_text1" background="images/deals_on_demand_red_bar1_over.jpg">
                        <% form_remote_tag :url => { :action => "confirmed_deals",:controller=>'customers'},:html=>{:id=>'confirmed_form'} do %>
                           <a href="#" class="deals_on_demand_text1_link" onclick="document.getElementById('confirmed_form').onsubmit();return false;">Confirmed Deals</a>
                        <%end%>
                        </td>
                        <td width="26%" align="center" background="images/deals_on_demand_red_bar1_over.jpg">
                        <% form_remote_tag :url => { :action => "accepted_deals",:controller=>'customers'},:html=>{:id=>'accepted_form'} do %>
                           <a href="#" class="deals_on_demand_text1_link" onclick="document.getElementById('accepted_form').onsubmit();return false;">Accepted Deals</a>
                        <%end%>
                        </td>
                        <td width="22%" align="center" background="images/deals_on_demand_red_bar1_over.jpg">
                        <% form_remote_tag :url => { :action => "new_deals",:controller=>'customers'},:html=>{:id=>'new_form'} do %>
                           <a href="#" class="deals_on_demand_text1_link" onclick="document.getElementById('new_form').onsubmit();return false;">New Deals</a>
                        <%end%>
                        </td>
                        <td width="24%" align="center" background="images/deals_on_demand_red_bar1_over.jpg">
                        <% form_remote_tag :url => { :action => "offered_demand_deals",:controller=>'customers'},:html=>{:id=>'offered_form'} do %>
                           <a href="#" class="deals_on_demand_text1_link" onclick="document.getElementById('offered_form').onsubmit();return false;">Offered Deals</a>
                        <%end%>
                        </td>
                      </tr>
                    </table>
                   </td>
                  </tr>
                  <tr>
                    <td height="25" align="left" class="deals_on_demand_text3">
                        <% form_remote_tag :url => { :action => "all_deals",:controller=>'customers'},:html=>{:id=>'all_form'} do %>
                           <a href="#" class="deals_on_demand_text1_link" onclick="document.getElementById('all_form').onsubmit();return false;">View all Deals</a>
                        <%end%>
                        </td>
                  </tr>
	          </table>

                  <div id="userform2">
                    <%= render :partial => "my_demand_deals_summary" %>
                  </div>
                </td>
              </tr>              
            </table></td>
            <td>&nbsp;</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>
              <div id="userform">
                <% if @demand_deal.blank? %>
                <%= render :partial => "i_want_deal_form" %>
                <% else %>
                <%= render :partial => "edit_i_want_deal_form" %>
                <% end %>
              </div>                            
            </td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
          </tr>

        </table></td>
      </tr>










